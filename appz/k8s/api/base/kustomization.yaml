apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - deployment-config.yaml
  - routes.yaml
  - services.yaml

namespace: devops-intern

commonLabels:
  #kscm: devops--ocp-kustomize-examples
  cluster: ocp-test
  app: todo-api
  template-compiler: kustomize

crds:
- ./crds/openshift-deploymentconfig.json
- ./crds/openshift-route.json

configurations:
- varconfig.yaml

vars:
- name: DEPLOYMENT_CONFIG_NAME
  objref:
    apiVersion: apps.openshift.io/v1
    kind: DeploymentConfig
    name: todo-api
  fieldref:
    fieldpath: metadata.name
- name: NAMESPACE
  objref:
    apiVersion: apps.openshift.io/v1
    kind: DeploymentConfig
    name: todo-api
  fieldref:
    fieldpath: metadata.namespace
- name: LABEL_CLUSTER
  objref:
    apiVersion: apps.openshift.io/v1
    kind: DeploymentConfig
    name: todo-api
  fieldref:
    fieldpath: metadata.labels.cluster
